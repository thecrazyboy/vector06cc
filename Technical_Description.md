# TO.TXT Verbatim #
<pre>
(с)  Тимошенко Александр Валерьевич (aka TIMSoft)<br>
URL:     http://vector06c.narod.ru/<br>
<br>
<br>
ТЕХНИЧЕСКОЕ ОПИСАНИЕ ПК "ВЕКТОР-06Ц"<br>
первая редакция от 17 ноября 1999 года<br>
<br>
В статье использованы материалы:<br>
- техническая документация на ПК "Вектор-06Ц"<br>
- информационные выпуски Центра "Компьютер" г.Кишинев (1990-1992)<br>
- информация, полученная от пользователей "Вектора" в ходе консультаций<br>
- личный опыт и наблюдения<br>
<br>
Аннотация<br>
<br>
Настоящее техническое описание предназначено для изучения работы<br>
машины вычислительной электронной цифровой персональной бытовой (БПЭВМ)<br>
"Вектор-06Ц" и ее составных частей.<br>
В настоящем техническом описании приводятся назначение и технические<br>
характеристики, дается описание структуры и принципов функционирования<br>
БПЭВМ и ее составных частей.<br>
<br>
1. Назначение и технические данные<br>
<br>
БПЭВМ "Вектор-06Ц" работает совместно с бытовым кассетным магнитофоном.<br>
Объем информации, записываемой на стандартную кассету типа МК-60:<br>
1) не менее 0.512 Мбайт при фазовой модуляции (скорость обмена 1500-<br>
2400 бод);<br>
2) не менее 0.36 Мбайт при частотной модуляции (скорость обмена<br>
1200 бод).<br>
Средства отображения информации на экране телевизора обеспечивают:<br>
1) отображение алфавитно-цифровой информации с возможностью изменения<br>
количества символов в строке до 80 и числа строк на экране до 25;<br>
2) загружаемый знакогенератор с емкостью до 256 символов;<br>
3) отображение символов в инверсном виде или в фоне цветного<br>
прямоугольника, констрастирующего с цветом символа;<br>
4) метод отображения знаков матричный (матрица произвольного размера);<br>
5) количество одновременно отображаемых цветов - произвольные 16 из<br>
256 цветовой палитры;<br>
6) количество цветов фона - до 256;<br>
7) возможность задания до 256 цветов границы экрана;<br>
8) одновременное отображение алфавитно-цифровой и графической<br>
информации;<br>
9) возможность создания многопланового изображения (количество планов -<br>
до 4);<br>
10) аппаратная поддержка вертикального сдвига отображаемой информации;<br>
11) количество отображаемых точек 256х256 при 16 цветах из 256 цветовой<br>
палитры и 512х256 при четырех цветах или 256х256 и 512х256 в монохромном<br>
режиме (1 цвет фона и 1 цвет изображения - любые из 256 цветовой палитры).<br>
БПЭВМ "Вектор-06Ц" обеспечивает возможность подключения дополнительных<br>
устройств:<br>
1) накопитель на гибком магнитном диске (дисковод)<br>
2) эмулятор дисковой памяти емкостью не менее 256Кбайт (квазидиск)<br>
3) печатающее устройство<br>
4) модуль внешнего ПЗУ<br>
5) 4 джойстика<br>
6) накопитель на жестком магнитном диске (винчестер)<br>
7) программатор<br>
8) COVOX<br>
9) музыкальный сопроцессор<br>
Существуют также разработки, позволяющие заменить процессор ВМ80А на Z80.<br>
<br>
2. Устройство и работа<br>
<br>
В БПЭВМ "Вектор-06Ц" используется общая оперативная память для<br>
микропроцессора и контроллера графического дисплея объемом 64Кбайта. Объем<br>
экранного ОЗУ, при числе адресуемых точек изображения 256х256 и 16-и цветах,<br>
равен 32Кбайт. Согласно принятой в данной БПЭВМ архитектуре и принципу<br>
функционирования экранного ОЗУ (байтовая организация и одновременное<br>
считывание 4-х байтов), микропроцессор и контроллер дисплея обращаются к ОЗУ<br>
по принципу "режима разделения времени" и высший приоритет - у контроллера<br>
дисплея.<br>
Блок системный конструктивно состоит из двух частей:<br>
1) модуль электронный (МЭ) системный;<br>
2) модуль клавиатуры.<br>
Модуль электронный системный состоит из следующих функциональных узлов:<br>
1) узел синхронизации;<br>
2) дисплейный узел;<br>
3) центральный процессор;<br>
4) узел управления;<br>
5) узел начальной загрузки и запуска;<br>
6) параллельный программируемый интерфейс и таймер;<br>
7) ОЗУ;<br>
8) узел сопряжения с магнитофоном.<br>
<br>
<br>
Область ОЗУ, соответствующая экрану расположена в адресах 8000Н-FFFFH<br>
(4 х 8 кБ = 32 кБ).<br>
Процессор к экранной области обращается также как и к остальной части<br>
ОЗУ, не различая их по каким-либо признакам.<br>
Для удобства описания экрана он делится на 4-е плоскости.<br>
<br>
Таблица плоскостей экранного ОЗУ<br>
┌────────────────┬─────────────┐<br>
│    Адресное    │    Номер    │<br>
│  пространство  │  плоскости  │<br>
│    плоскости   │             │<br>
├────────────────┼─────────────┤<br>
│   E000-FFFF    │      0      │<br>
│   C000-DFFF    │      1      │<br>
│   A000-BFFF    │      2      │<br>
│   8000-9FFF    │      3      │<br>
└────────────────┴─────────────┘<br>
<br>
Каждая плоскость соответствует 256*256 точкам. Каждый байт плоскости<br>
соответствует сразу 8-и точкам, расположенным рядом на одной горизонтальной<br>
линии. Причем старший бит соответствует самой левой точке. Вся плоскость<br>
графического экрана состоит из 8-и точечных черточек. Самому младшему адресу<br>
"черточки" соответствует левая нижняя черточка. Следующая черточка<br>
расположена над ней и т.д. до самого верха (8000H-80FFH). Черточка с адресом<br>
8100Н геометрически расположена правее черточки с адресом 8000Н. Адрес самой<br>
верхней правой черточки в этой плоскости - 9FFFH. Остальные три плоскости<br>
(в реж. 256*256) аналогичны и совпадают геометрически.<br>
Таким образом, каждой геометрической точке экрана соответствует по одному<br>
биту в каждой из 4-х плоскостей. Эти четыре бита и определяют номер цвета<br>
0-15. Сам физический цвет определяется содержимым К155РУ2 по адресу,<br>
сформированному из этих 4-х битов. Разряды байта, определяющего физический<br>
цвет, включают или выключают соответсвующий разряд ЦАП и обеспечивают палитру<br>
из 256 цветов. Соответствие разрядов и весов цветов следующие:<br>
D0 - 1 красный    D1 - 2 красный    D2 - 4 красный<br>
D3 - 1 заленый    D4 - 2 зеленый    D5 - 4 зеленый<br>
D6 - 2 синий      D7 - 4 синий<br>
<br>
В режиме 512*256 устройство экрана в чем-то похоже. Но здесь только две<br>
расширенные плоскости. Одна из них состоит из 1-й и 4-й, другая из 2-й и 3-й.<br>
Обе эти расширенные плоскости геометрически эквивалентны. Чтобы представить,<br>
как получается геометрический образ расширенной плоскости из двух обычных,<br>
рассмотрим две плоскости друг за дружкой. Мысленно точки растащим по<br>
горизонтали так, чтобы между ними образовалось расстояние размером в одну<br>
точку. А теперь одну из плоскостей сдвинем вправо так, чтобы в промежутках<br>
одной плоскости стали бы видны точки другой. По вертикали точек становится<br>
256, а по горизонтали удвоится и станет равно 512.<br>
Дополнительно необходимо помнить, что верхняя строка графического экрана<br>
только тогда совпадает с геометрически верхней линией дисплея, когда номер<br>
верхней строки устанавливается равным - FFH.<br>
Информация об одной точке на экране в режиме 256х256 хранится в<br>
одноименных битах плоскостей экранного ОЗУ. Так, например, информация о<br>
первых восьми точках растра хранится в байтах 80FF, A0FF, C0FF, E0FF, а о<br>
последних восьми точках в байтах - 9F00, BF00, DF00, FF00.<br>
В режиме 512х256 информация о четной точке растра хранится в плоскостях<br>
три и два, а о нечетной - в плоскостях нуль, один.<br>
Значение весовых коэффициентов в математическом цвете (коде, поступающем на<br>
адресные входы таблицы цветов) у битов из плоскостей экрана следующее:<br>
- в режиме 256х256 (16 цветов) у плоскостей 0, 1, 2 и 3 соответственно<br>
1, 2, 4, 8;<br>
- в режиме 512х256 (4 цвета) у плоскостей 0, 1, 2 и 3 соответственно<br>
1, 2, 1, 2.<br>
Управление режимами дисплея и управление заданием цвета фона рабочей<br>
и нерабочей области экрана осуществляется через порт 02-РВ (0...3) и<br>
переключатель режимов, что позволяет:<br>
- перевести дисплей из режима 256х256 в режим 512х256 путем разделения<br>
плоскостей экрана на две пары;<br>
- установить объем памяти дисплея (объем экранного ОЗУ) равным 8, 16, 24<br>
и 32 Кбайт, изменяя содержимое таблицы цветов, т.е. отобразить информацию<br>
соответственно из одной, двух, трех, четырех плоскостей экранного ОЗУ.<br>
Таблица цветов преобразовывает математический цвет (информация, хранимая<br>
в экранном ОЗУ) в физический цвет (сигнал, поступающий с выходов таблицы<br>
цветов на цифро-аналоговые преобразователи (ЦАП). Обеспечивает задание<br>
количества цветов до 16 из 256 возможных. Изменение содержимого таблицы<br>
производится программно. Запись таблицы цветов осуществляется во время<br>
обратного хода кадровой развертки. При этом в порт 02-РВ (0...3)<br>
записывается код математического цвета.<br>
<br>
Матрица клавиатуры<br>
<br>
│ 7   6   5   4   3   2   1   0<br>
───┼───────────────────────────────<br>
7 │SPC  ^   ]   \   [   Z   Y   X<br>
6 │ W   V   U   T   S   R   Q   P<br>
5 │ O   N   M   L   K   J   I   H<br>
4 │ G   F   E   D   C   B   A   @<br>
3 │ /   .   =   ,   ;   :   9   8<br>
2 │ 7   6   5   4   3   2   1   0<br>
1 │F5  F4  F3  F2  F1  AP2 CTP ^\<br>
0 │DN  RT  UP  LT  ЗАБ ВК  ПС  TAB<br>
<br>
<br>
Краткое описание аппаратных средств и способов программного обращения<br>
к этим средствам.<br>
<br>
Обращение производится при помощи команд микропроцессора IN PORT,<br>
OUT PORT, где PORT - номера портов, описание которых приведено в таблице.<br>
<br>
╔══════╤═════╤═══════════════════════════════════════════════════════════╗<br>
║      │     │            назначение разрядов канала                     ║<br>
║ порт │ бит ├──────────────────────────────┬────────────────────────────╢<br>
║      │     │     режим "Клавиатура"       │      режим "Дисплей"       ║<br>
║      │     │ при обр.ходе кадр. развертки │ при отображении информации ║<br>
╠══════╪═════╪══════════════════════════════╧════════════════════════════╣<br>
║  00  │  -  │ РУС                                                       ║<br>
╟──────┼─────┼───────────────────────────────────────────────────────────╢<br>
║  01  │  0  │ вых. сигнал на маг.                           \           ║<br>
║ (PC) │  1  │ управление реле (автосброс из режима ВВОД)     \ вывод    ║<br>
║      │  2  │ "СО" клавиатуры (не исп.)                      /          ║<br>
║      │  3  │ управление светодиодом РУС   0(1)-выкл.(вкл.) /           ║<br>
║      │  4  │ вх. сигнал с маг.                             \           ║<br>
║      │  5  │ клавиша СС         0(1) - наж.(отжата)         \ ввод     ║<br>
║      │  6  │ клавиша УС         0(1) - наж.(отжата)         /          ║<br>
║      │  7  │ клавиша РУС/ЛАТ    0(1) - наж.(отжата)        /           ║<br>
╟──────┼─────┼──────────────────────────────┬────────────────────────────╢<br>
║  02  │  0  │ адрес (матем. │ считывание   │ \                          ║<br>
║ (PB) │  1  │ цвет), посту-   кода         │  номер цвета (выв.)        ║<br>
║      │  2  │ пающий на     │ сканирования │  бордюра                   ║<br>
║      │  3  │ таблицу         клавиатуры   │ /                          ║<br>
║      │  4  │ цветности при │ (ввод)       │ 0(1)-256(512) точек (выв.) ║<br>
║      │  5  │ ее записи                    │                            ║<br>
║      │  6  │               │              │                            ║<br>
║      │  7  │                              │                            ║<br>
╟──────┼─────┼──────────────────────────────┼────────────────────────────╢<br>
║  03  │  0  │ код                          │ номер                      ║<br>
║ (PA) │  1  │ сканирования                 │ верхней                    ║<br>
║      │  2  │ клавиатуры                   │ строки                     ║<br>
║      │  3  │ (вывод)                      │ регенерации                ║<br>
║      │  4  │                              │ экрана                     ║<br>
║      │  5  │                              │ (вывод)                    ║<br>
║      │  6  │                              │                            ║<br>
║      │  7  │                              │                            ║<br>
╟──────┼─────┼──────────────────────────────┴────────────────────────────╢<br>
║  04  │  -  │ РУС                                                       ║<br>
║  05  │  -  │ порт С параллельного интерфейса                           ║<br>
║  06  │  -  │ порт В -//-                                               ║<br>
║  07  │  -  │ порт А -//-                                               ║<br>
╟──────┼─────┼───────────────────────────────────────────────────────────╢<br>
║  08  │  -  │ РУС                                                       ║<br>
║  09  │  -  │ счетчик 2 интегрального таймера ВИ53                      ║<br>
║  0А  │  -  │ счетчик 1 -//-                                            ║<br>
║  0В  │  -  │ счетчик 0 -//-                                            ║<br>
╟──────┼─────┼───────────────────────────────────────────────────────────╢<br>
║  0C  │  -  │ запись байта данных в таблицу цветности                   ║<br>
║  0D  │  -  │                                                           ║<br>
║  0E  │  -  │ чтение байта 1-го джойстика                               ║<br>
║  0F  │  -  │ чтение байта 2-го джойстика                               ║<br>
║  10  │  -  │ управление переключением ОЗУ электронного диска           ║<br>
║  18  │  -  │ регистр данных контроллера НГМД                           ║<br>
║  19  │  -  │ регистр сектора дорожки контролллера НГМД                 ║<br>
║  1A  │  -  │ регистр дорожки контроллера НГМД                          ║<br>
║  1B  │  -  │ регистр команд и статуса контроллера НГМД                 ║<br>
║  1C  │  -  │ регистр выбора и управления контроллера НГМД              ║<br>
╚══════╧═════╧═══════════════════════════════════════════════════════════╝<br>
<br>
Трехканальный порт ВВ55 (порты 01, 02, 03) предназначен для<br>
осуществления программного доступа к узлу сопряжения с магнитофоном, к<br>
клавиатуре, к сдвигающим регистрам, счетчику адреса текущей строки<br>
отображения, к динамической головке.<br>
Необходимый режим работ задается посредством записи в порт с адресом 00<br>
кода управляющего слова.<br>
Примерно каждые 20 мс на процессор приходит аппаратное прерывание. Если<br>
прерывания разрешены, то происходит вызов подпрограммы по адресу 38Н или<br>
другими словами выполняется команда RST7. Момент времени прерывания совпадает<br>
с моментом окончания сканирования луча монитора в видимой части дисплея.<br>
Программа, работающая по прерыванию, производит программирование ВВ55<br>
на режим, позволяющий опросить клавиатуру. Поэтому перед возвратом из<br>
подпрограммы необходимо обратно восстановить дисплейный режим и значения<br>
портов, определяющих номер верхней строки, цвет рамки, режим 256*256 или<br>
512*256 и т.п. Также необходимо разрешить прерывание, т.к. аппаратное<br>
прерывание сбрасывает программный триггер.<br>
<br>
Трехканальный порт ВВ55 (порты 05, 06, 07) предназначен для<br>
осуществления программного доступа к периферийным устройствам (печать,<br>
локальная сеть, внеш. ПЗУ и др.). Все порты подключены к 30-контактному<br>
внешнему разъему.<br>
Необходимый режим работы задается посредством записи в порт 04 кода<br>
управляющего слова.<br>
<br>
Таймер представляет собой три программируемых шестнадцатеричных<br>
счетчика 0, 1, 2, которые вырабатывают на своих выходах импульсные сигналы.<br>
Таймер реализован на микросхеме КР580ВИ53. Выходы всех счетчиков<br>
подключены к динамической головке через транзисторный усилитель.<br>
<br>
<br>
<br>
<br>
ОПИСАНИЕ ПОРТОВ<br>
<br>
00H  РУС (регистр управляющего слова трехканального порта ВВ55)<br>
01H  Порт PC<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: выходной сигнал на магнитофон<br>
║ ║ ║ ║ ║ ║ ╚═══  1: управление реле (автосброс из режима ВВОД)<br>
║ ║ ║ ║ ║ ╚═════  2: "СО" клавиатуры (не используется)<br>
║ ║ ║ ║ ╚═══════  3: управление светодиодом РУС/LAT 0(1)-выкл(вкл)<br>
║ ║ ║ ╚═════════  4: входной сигнал с магнитофона<br>
║ ║ ╚═══════════  5: клавиша СС         0(1) - нажата(отжата)<br>
║ ╚═════════════  6: клавиша УС         0(1) - нажата(отжата)<br>
╚═══════════════  7: клавиша РУС/LAT    0(1) - нажата(отжата)<br>
02H  Порт PB<br>
03H  Порт PC<br>
04H  РУС (регистр управляющего слова трехканального порта ВВ55)<br>
05H  порт PС параллельного интерфейса (разъем "ПУ")<br>
06H  порт PB параллельного интерфейса (разъем "ПУ")<br>
07H  порт PA параллельного интерфейса (разъем "ПУ")<br>
08H  РУС (регистр управляющего слова интегрального таймера ВИ53)<br>
09H  Счетчик 2 таймера<br>
0АH  Счетчик 1 таймера<br>
0ВH  Счетчик 0 таймера<br>
0CH  Регистр записи байта данных в таблицу цветности<br>
0DH  нет информации<br>
0EH  Чтение байта 1-го джойстика<br>
0FH  Чтение байта 2-го джойстика<br>
10H  Управление переключением ОЗУ электронного диска<br>
18H  Регистр данных контроллера НГМД<br>
19H  Регистр сектора дорожки контролллера НГМД<br>
1AH  Регистр дорожки контроллера НГМД<br>
1BH  Регистр команд и статуса контроллера НГМД<br>
1CH  Регистр выбора и управления контроллера НГМД<br>
<br>
<br>
<br>
<br>
Описание портов контроллера жесткого диска<br>
<br>
50,58 Регистр данных. Чтение(запись) данных в(из) буфер сектора контроллера<br>
51H  Запись: Write Precompensation register.  Turn on write precompensation.<br>
Чтение: Регистр ошибок. Содержит признаки последней ошибки.<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │0│ │0│ │ │ ║<br>
╙╥┴╥┴─┴╥┴─┴╥┴╥┴╥╜ бит<br>
║ ║   ║   ║ ║ ╚═  0: адресный маркер данных не найден<br>
║ ║   ║   ║ ╚═══  1: ошибка на дорожке 0<br>
║ ║   ║   ╚═════  2: команда отвергнута<br>
║ ║   ╚═════════  4: ID сектора не найден<br>
║ ╚═════════════  6: ошибка ECC: некорректируемая ошибка данных<br>
╚═══════════════  7: плохой блок<br>
<br>
52H  Счетчик числа секторов для операции чтения/записи<br>
<br>
53H  Текущий/начальный номер логического сектора для чтения/записи<br>
54H  Цилиндр, старшие (биты 0-1 - это биты 8-9 10-битового номера цилиндра)<br>
55H  Цилиндр, младшие (биты 0-7 10-битового номера цилиндра)<br>
56H  Биты определяют устройство и головку для операции чтения/записи<br>
<br>
57H  Запись: регистр команды (См. Tech Ref о подробностях)<br>
1xH = сброс на цилиндр 0 (x = step rate)<br>
7xH = искать до цилиндра (x = step rate)<br>
2xH = сектор чтения (x = retry and ECC-read)<br>
3xH = сектор записи (x = retry and ECC-read)<br>
50H = форматировать дорожку<br>
4xH = чтение для верификации (x = retry)<br>
90H = диагностика<br>
91H = уст.параметры (число головок, секторов) для выбр.устр.<br>
57H  Чтение: регистр статуса<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: 1=предыдущая команда закончилась с ошибкой<br>
║ ║ ║ ║ ║ ║ ╚═══  1: уст. в 1 при обнаружении индексного отверстия<br>
║ ║ ║ ║ ║ ╚═════  2: данные исправлены. Была ошибка, но ECC исправил.<br>
║ ║ ║ ║ ╚═══════  3: запрос данных. Буфер ждет данных (занято)<br>
║ ║ ║ ╚═════════  4: поиск завершен<br>
║ ║ ╚═══════════  5: сбой записи<br>
║ ╚═════════════  6: устройство готово к операции (если бит 4=1)<br>
╚═══════════════  7: занято. 1=работает команда (другие биты неверны)<br>
5fH  Системный сброс (лучше не пользоваться, сходство с 57Н без обнуления<br>
микросхем жесткого диска).<br>
<br>
<br>
ФОРМАТЫ ЗАПИСИ НА МАГНИТНУЮ ЛЕНТУ<br>
<br>
-- ФОРМАТ MON ---------------------------------------------------------------<br>
Формат записи на магнитную ленту директивой Монитора W следующий:<br>
1. Вначале записывается заголовок MON и имя файла:<br>
- header 256*0h байт;<br>
- синхробайт 0E6h;<br>
- 4*0D2h байт;<br>
- имя (до 11 байт);<br>
- 3*0h байт.<br>
2. Далее пишется сам файл:<br>
- header 256*0h байт;<br>
- синхробайт 0E6h;<br>
- ст., мл. байт адреса начала;<br>
- ст., мл. байт адреса конца;<br>
- байты файла;<br>
- 1 байт контр. суммы всех байтов без переноса.<br>
При записи директивой W без имени файла пишется только вторая часть файла.<br>
<br>
-- ФОРМАТ ROM ---------------------------------------------------------------<br>
Формат записи на магнитную ленту директивой Монитора O следующий:<br>
Вначале передается преамбула: 4 серии блоков (25 нулей и 25 код 55Н).<br>
Затем передаются информационные блоки. Каждый блок начинается с серии:<br>
16 нулей, 4 байта - 55Н, 1 байт - Е6Н, 4 байта - 0, 30 байт - заголовок блока<br>
(включает идентификатор "NODISC00", имя файла и расширение - 11 байт, дата -<br>
6 байт, начальный адрес загрузки программы, количество блоков, остаток блоков<br>
для передачи), 1 байт - контрольная сумма.<br>
Пример записи на ленту (программа COPY V 1.1):<br>
<br>
Преамбула:<br>
00, 00, ... 00, 55, 55, ... 55,<br>
00, 00, ... 00, 55, 55, ... 55,<br>
00, 00, ... 00, 55, 55, ... 55,<br>
00, 00, ... 00, 55, 55, ... 55,<br>
<br>
1 блок:<br>
(1-я      00, 00, 00, 00, 00, 00, 00, 00, 00, 00,<br>
копия     00, 00, 00, 00, 00, 00, 55, 55, 55, 55,<br>
блока)    E6, 00, 00, 00, 00,<br>
NODISC00260987COPY_V11COM, 00,<br>
00, 00, 09, 09, D0<br>
подблоки  00, 00, 00, 00, E6, 80, D0, [32 байта инф.], 0A,<br>
00, 00, 00, 00, E6, 81, D0, [32 байта инф.], 30,<br>
00, 00, 00, 00, E6, 82, D0, [32 байта инф.], B2,<br>
00, 00, 00, 00, E6, 83, D0, [32 байта инф.], B2,<br>
00, 00, 00, 00, E6, 84, D0, [32 байта инф.], 65,<br>
00, 00, 00, 00, E6, 85, D0, [32 байта инф.], 94,<br>
00, 00, 00, 00, E6, 86, D0, [32 байта инф.], 38,<br>
00, 00, 00, 00, E6, 87, D0, [32 байта инф.], C2<br>
<br>
(2-я      00, 00, 00, 00, 00, 00, 00, 00, 00, 00,<br>
копия     00, 00, 00, 00, 00, 00, 55, 55, 55, 55,<br>
блока)    E6, 00, 00, 00, 00,<br>
NODISC00260987COPY_V11COM, 00,<br>
00, 00, 09, 09, D0<br>
подблоки  00, 00, 00, 00, E6, 88, D0, [32 байта инф.], 12,<br>
.........<br>
00, 00, 00, 00, E6, 8F, D0, [32 байта инф.], CA<br>
<br>
2 блок:<br>
(1-я      00, 00, 00, 00, 00, 00, 00, 00, 00, 00,<br>
копия     00, 00, 00, 00, 00, 00, 55, 55, 55, 55,<br>
блока)    E6, 00, 00, 00, 00,<br>
NODISC00260987COPY_V11COM, 00,<br>
00, 00, 09, 09, D0<br>
подблоки  00, 00, 00, 00, E6, 80, D0, [32 байта инф.], 52,<br>
.........<br>
00, 00, 00, 00, E6, 87, D0, [32 байта инф.], 4D<br>
<br>
и так далее...<br>
<br>
-- ФОРМАТ BAS ---------------------------------------------------------------<br>
Информации нет<br>
<br>
<br>
<br>
СЛУЖЕБНЫЕ КОНСТАНТЫ, ПОДПРОГРАММЫ МОНИТОРА<br>
<br>
Служебные ячейки начального загрузчика:<br>
<br>
0DEEFH - начальный блок<br>
0DEF0H - число блоков<br>
0DEF1H - адрес текущего блока<br>
0DEF7H - код нажатой клавиши:<br>
биты:    ст                      мл<br>
клавиша: F5 F4 F3 F2 F1 AP2 CTP HOME<br>
<br>
=============================================================================<br>
Служебные ячеки Бейсика v2.5:<br>
<br>
ROM-файл:<br>
3C60H - начало встроенной бейсик-программы<br>
RAM (в загруженном Бейсике):<br>
4300H - начало загруженной бейсик-программы<br>
<br>
=============================================================================<br>
Служебные ячейки Бейсика v2.5 (обращение через PEEK и POKE):<br>
<br>
0...639   - знакогенератор (128 символов по 5 байт на каждый символ)<br>
768...770 - состояние внутреннего таймера<br>
771       - сдвиг экрана (вертикальный скроллинг)<br>
772...775 - счетчики нот при исполнении музыки<br>
17152     - начало бейсик-программы, мл.разряд адреса начала след. строки<br>
17153     - ст.разряд адреса начала следующей строки программы<br>
17154     - мл.разряд номера строки программы  \<br>
17155     - ст.разряд номера строки программы   \  строка<br>
...      - коды символов программы             / программы<br>
...      - маркер конца строки (00)           /<br>
...      - мл.разряд адреса начала следующей строки<br>
...      - ст.разряд адреса начала следующей строки<br>
...      - строка программы<br>
...      - ...<br>
...      - маркер конца программы (00,00)<br>
<br>
=============================================================================<br>
Адреса подпрограмм Монитора-отладчика (для двух вариантов загрузки).<br>
<br>
При работе Монитор поддерживает сохранение системных переходов:<br>
-00 JMP 'монитор' (адрес соответствует началу таблицы переходов на<br>
стандартные подпрограммы)<br>
-05 JMP 'эмулятор' в ДОС (адрес соответствует начальному адресу в ОЗУ<br>
монитора-отладчика)<br>
-28 JMP RST5 (программа обработки прерываний по команде RST5)<br>
-38 JMP PRER (программа обработки прерываний по команде RST7.<br>
Данное прерывание инициализируется системой каждые 20 мсек)<br>
<br>
7803H(F803H) - ввод символа с клавиатуры<br>
Вх: нет<br>
Вых: А - введенный код<br>
<br>
7806H(F806H) - ввод байта с магнитофона<br>
Вх: А=FF - с поиском синхробайта<br>
А=08 - без поиска синхробайта<br>
Вых: А - введенный байт<br>
<br>
7809H(F809H) - вывод символа на экран<br>
Вх: С - выводимый код<br>
Вых: нет<br>
<br>
780CH(F80CH) - запись байта на магнитофон<br>
Вх: С - выводимый код<br>
Вых: нет<br>
<br>
780FH(F80FH) - вывод символа на принтер<br>
Вх: С -выводимый код<br>
Вых: нет<br>
<br>
7812H(F812H) - опрос статуса клавиатуры<br>
Вх: нет<br>
Вых: А=00 - не нажата<br>
А=FF - нажата<br>
<br>
7815H(F815H) - распечатка байта в HEX-виде<br>
Вх: A - выводимый код<br>
Вых: нет<br>
<br>
7818H(F818H) - вывод сообщения на экран<br>
Вх: HL - адрес начала (сообщение заканчивается нулевым байтом)<br>
Вых: нет<br>
<br>
<br>
<br>
781BH(F81BH) - ввод кода нажатой клавиши<br>
Вх: нет<br>
Вых: A=FF - не нажата<br>
A='код клавиши'<br>
<br>
ОПИСАНИЕ ПОРТОВ ПК "ВЕКТОР-06Ц"<br>
<br>
по материалам из разных источников<br>
составил Тимошенко А.В. timsoft@mail.ru<br>
<br>
<br>
00H  РУС (регистр управляющего слова трехканального порта ВВ55)<br>
01H  Чтение: порт РС<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │x│x│x│x║<br>
╙╥┴╥┴╥┴╥┴─┴─┴─┴─╜ бит<br>
║ ║ ║ ╚═════════  4: входной сигнал с магнитофона<br>
║ ║ ╚═══════════  5: клавиша СС         0(1) - нажата(отжата)<br>
║ ╚═════════════  6: клавиша УС         0(1) - нажата(отжата)<br>
╚═══════════════  7: клавиша РУС/LAT    0(1) - нажата(отжата)<br>
Запись: порт РС<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║x│x│x│x│ │ │ │ ║<br>
╙─┴─┴─┴─┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ╚═  0: выходной сигнал на магнитофон<br>
║ ║ ╚═══  1: управление реле (автосброс из режима ВВОД)<br>
║ ╚═════  2: "СО" клавиатуры (не используется)<br>
╚═══════  3: управление светодиодом РУС/LAT 0(1)-выкл(вкл)<br>
02H  Чтение: Режим "Клавиатура" при обратном ходе кадровой развертки<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: \<br>
║ ║ ║ ║ ║ ║ ╚═══  1:  \<br>
║ ║ ║ ║ ║ ╚═════  2:   \<br>
║ ║ ║ ║ ╚═══════  3:    \ состояние рядов<br>
║ ║ ║ ╚═════════  4:    / матрицы клавиатуры<br>
║ ║ ╚═══════════  5:   /<br>
║ ╚═════════════  6:  /<br>
╚═══════════════  7: /<br>
Запись: Режим "Клавиатура" при обратном ходе кадровой развертки<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║х│х│х│х│ │ │ │ ║<br>
╙─┴─┴─┴─┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ╚═  0: \<br>
║ ║ ╚═══  1:  \ номер регистра палитры<br>
║ ╚═════  2:  / при программировании<br>
╚═══════  3: /<br>
Запись: Режим "Дисплей" при отображении информации<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║х│х│х│ │ │ │ │ ║<br>
╙─┴─┴─┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ╚═  0: \<br>
║ ║ ║ ╚═══  1:  \ "математический" код<br>
║ ║ ╚═════  2:  / текущего цвета бордюра<br>
║ ╚═══════  3: /<br>
╚═════════  4: текущий режим экрана (1=512 точек, 0=256 точек)<br>
03H  Запись: Режим "Клавиатура" при обратном ходе кадровой развертки<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: \<br>
║ ║ ║ ║ ║ ║ ╚═══  1:  \<br>
║ ║ ║ ║ ║ ╚═════  2:   \<br>
║ ║ ║ ║ ╚═══════  3:    \ опрос рядов матрицы клавиатуры<br>
║ ║ ║ ╚═════════  4:    / 0=опрос ряда разрешен<br>
║ ║ ╚═══════════  5:   /<br>
║ ╚═════════════  6:  /<br>
╚═══════════════  7: /<br>
Запись: Режим "Дисплей" при отображении информации<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: \<br>
║ ║ ║ ║ ║ ║ ╚═══  1:  \<br>
║ ║ ║ ║ ║ ╚═════  2:   \<br>
║ ║ ║ ║ ╚═══════  3:    \ позиция вертикального скроллинга экрана,<br>
║ ║ ║ ╚═════════  4:    / младший байт адреса начала растра<br>
║ ║ ╚═══════════  5:   /<br>
║ ╚═════════════  6:  /<br>
╚═══════════════  7: /<br>
04H  РУС (регистр управляющего слова трехканального порта ВВ55)<br>
05H  порт PС параллельного интерфейса (разъем "ПУ")<br>
Запись: Манипулятор типа "Мышь"<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║x│x│ │x│x│x│x│x║<br>
╙─┴─┴╥┴─┴─┴─┴─┴─╜ бит<br>
╚═══════════  5: 1=сброс<br>
Запись: Опрос джойстиков П1, П2<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║х│ │ │x│х│х│х│х║<br>
╙─┴╥┴╥┴─┴─┴─┴─┴─╜ бит<br>
║ ╚═══════════  5: 0=джойстик П1, 1=джойстик П2<br>
╚═════════════  6: 1=джойстик П1, 0=джойстик П2<br>
06H  порт PB параллельного интерфейса (разъем "ПУ")<br>
Чтение: Манипулятор типа "Мышь" (аналогично джойстикам П1, П2)<br>
Чтение: Джойстики П1, П2 (0 - клавиша нажата, 1 - отжата)<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │x│x│ │ │ │ ║<br>
╙╥┴╥┴─┴─┴╥┴╥┴╥┴╥╜ бит<br>
║ ║     ║ ║ ║ ╚═  0: "вправо"<br>
║ ║     ║ ║ ╚═══  1: "влево"<br>
║ ║     ║ ╚═════  2: "вверх"<br>
║ ║     ╚═══════  3: "вниз"<br>
║ ╚═════════════  6: кнопка 2<br>
╚═══════════════  7: кнопка 1<br>
07H  порт PA параллельного интерфейса (разъем "ПУ")<br>
Чтение: Джойстик УСПИД (1 - клавиша нажата, 0 - отжата)<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │x│x│x║<br>
╙╥┴╥┴╥┴╥┴╥┴─┴─┴─╜ бит<br>
║ ║ ║ ║ ╚═══════  3: "кнопка"<br>
║ ║ ║ ╚═════════  4: "влево"<br>
║ ║ ╚═══════════  5: "вниз"<br>
║ ╚═════════════  6: "вправо"<br>
╚═══════════════  7: "вверх"<br>
08H  РУС (регистр управляющего слова интегрального таймера ВИ53)<br>
09H  Счетчик №2 таймера<br>
0АH  Счетчик №1 таймера<br>
0ВH  Счетчик №0 таймера<br>
0CH  Регистр записи байта данных в таблицу цветности<br>
0DH  Запись: таблица цветности<br>
0EH  Запись: таблица цветности<br>
Чтение: Регистр 1-го джойстика (0 - клавиша нажата, 1 - отжата)<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │1│1│ │ │ │ ║<br>
╙╥┴╥┴─┴─┴╥┴╥┴╥┴╥╜ бит<br>
║ ║     ║ ║ ║ ╚═  0: "вправо"<br>
║ ║     ║ ║ ╚═══  1: "влево"<br>
║ ║     ║ ╚═════  2: "вверх"<br>
║ ║     ╚═══════  3: "вниз"<br>
║ ╚═════════════  6: кнопка 1<br>
╚═══════════════  7: кнопка 2<br>
0FH  Запись: таблица цветности<br>
Чтение: Регистр 2-го джойстика (0 - клавиша нажата, 1 - отжата)<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │1│1│ │ │ │ ║<br>
╙╥┴╥┴─┴─┴╥┴╥┴╥┴╥╜ бит<br>
║ ║     ║ ║ ║ ╚═  0: "вправо"<br>
║ ║     ║ ║ ╚═══  1: "влево"<br>
║ ║     ║ ╚═════  2: "вверх"<br>
║ ║     ╚═══════  3: "вниз"<br>
║ ╚═════════════  6: кнопка 1<br>
╚═══════════════  7: кнопка 2<br>
10H  Управление переключением ОЗУ электронного диска<br>
Запись<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: \ номер блока при обращении к электронному диску<br>
║ ║ ║ ║ ║ ║ ╚═══  1: / "как ОЗУ"<br>
║ ║ ║ ║ ║ ╚═════  2: \ номер блока при обращении к электронному диску<br>
║ ║ ║ ║ ╚═══════  3: / "как стек"<br>
║ ║ ║ ╚═════════  4: 0-выкл/1-вкл режима обращения "как стек"<br>
║ ║ ╚═══════════  5: 0-выкл/1-вкл режима обращения "как ОЗУ"<br>
║ ╚═════════════  6: \ только для кировского диска! (автор Саттаров)<br>
╚═══════════════  7: / выбор области для обращения "как ОЗУ"<br>
00 - 0A000h-0DFFFh (как в кишиневском)<br>
01 - 0A000h-0FFFFh<br>
10 -  8000h-0DFFFh<br>
11 -  8000h-0FFFFh<br>
<br>
14H  Регистр данных Sound Tracker<br>
15H  Номер регистра Sound Tracker<br>
<br>
18H  Регистр данных контроллера НГМД<br>
19H  Регистр сектора дорожки контролллера НГМД<br>
1AH  Регистр дорожки контроллера НГМД<br>
1BH  Регистр команд и статуса контроллера НГМД<br>
1CH  Регистр выбора и управления контроллера НГМД<br>
<br>
20H  Часы реального времени<br>
22H  Часы реального времени<br>
<br>
28H  Порт модема<br>
30H  Порт модема<br>
38H  Порт модема<br>
<br>
Описание портов контроллера жесткого диска<br>
<br>
50H  Регистр данных. Чтение(запись) данных в(из) буфер сектора контроллера<br>
51H  Запись: Write Precompensation register.  Turn on write precompensation.<br>
Чтение: Регистр ошибок. Содержит признаки последней ошибки.<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │0│ │0│ │ │ ║<br>
╙╥┴╥┴─┴╥┴─┴╥┴╥┴╥╜ бит<br>
║ ║   ║   ║ ║ ╚═  0: адресный маркер данных не найден<br>
║ ║   ║   ║ ╚═══  1: ошибка на дорожке 0<br>
║ ║   ║   ╚═════  2: команда отвергнута<br>
║ ║   ╚═════════  4: ID сектора не найден<br>
║ ╚═════════════  6: ошибка ECC: некорректируемая ошибка данных<br>
╚═══════════════  7: плохой блок<br>
52H  Счетчик числа секторов для операции чтения/записи<br>
53H  Текущий/начальный номер логического сектора для чтения/записи<br>
54H  Цилиндр, старшие (биты 0-1 - это биты 8-9 10-битового номера цилиндра)<br>
55H  Цилиндр, младшие (биты 0-7 10-битового номера цилиндра)<br>
56H  Биты определяют устройство и головку для операции чтения/записи<br>
57H  Запись: регистр команды (См. Tech Ref о подробностях)<br>
1xH = сброс на цилиндр 0 (x = step rate)<br>
7xH = искать до цилиндра (x = step rate)<br>
2xH = сектор чтения (x = retry and ECC-read)<br>
3xH = сектор записи (x = retry and ECC-read)<br>
50H = форматировать дорожку<br>
4xH = чтение для верификации (x = retry)<br>
90H = диагностика<br>
91H = уст.параметры (число головок, секторов) для выбр.устр.<br>
Чтение: регистр статуса<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: 1=предыдущая команда закончилась с ошибкой<br>
║ ║ ║ ║ ║ ║ ╚═══  1: уст. в 1 при обнаружении индексного отверстия<br>
║ ║ ║ ║ ║ ╚═════  2: данные исправлены. Была ошибка, но ECC исправил.<br>
║ ║ ║ ║ ╚═══════  3: запрос данных. Буфер ждет данных (занято)<br>
║ ║ ║ ╚═════════  4: поиск завершен<br>
║ ║ ╚═══════════  5: сбой записи<br>
║ ╚═════════════  6: устройство готово к операции (если бит 4=1)<br>
╚═══════════════  7: занято. 1=работает команда (другие биты неверны)<br>
58H  Регистр данных. Чтение(запись) данных в(из) буфер сектора контроллера<br>
5fH  Системный сброс (лучше не пользоваться, сходство с 57Н без обнуления<br>
микросхем жесткого диска).<br>
80H-8FH, 0A0H-0AFH Управляющий порт адаптера Z80<br>
80H  Управляющий порт адаптера Z80 (вариант "Кишинев" автор Фролов)<br>
Запись<br>
╓7┬6┬5┬4┬3┬2┬1┬0╖<br>
║ │ │ │ │ │ │ │ ║<br>
╙╥┴╥┴╥┴╥┴╥┴╥┴╥┴╥╜ бит<br>
║ ║ ║ ║ ║ ║ ║ ╚═  0: включение синклеровского экрана<br>
║ ║ ║ ║ ║ ║ ╚═══  1: инверсия старшего бита адреса ОЗУ<br>
║ ║ ║ ║ ║ ╚═════  2: взаимная замена ОЗУ ПК  <->  ОЗУ Эл.диска -<br>
║ ║ ║ ║ ║            инверсия сигнала STEC<br>
║ ║ ║ ║ ╚═══════  3: обращение к квазидиску в операциях с (HL).<br>
║ ║ ║ ║              формирование STEC при обращении к адресу (HL)<br>
║ ║ ║ ╚═════════  4: немаскируемое прерывание по незнакомым портам<br>
║ ║ ╚═══════════  5: блокировка STEC при обращении к адресам ОЗУ<br>
║ ║		    4000-5FFFH (блокировка эл.диска), блокировка записи<br>
║ ║                  при обращении к адресам 0-3FFFH (имитация ПЗУ)<br>
║ ╚═════════════  6: увеличение быстродействия некоторых операций<br>
╚═══════════════  7: блокировка обращения к квазидиску в<br>
стековых операциях - выключение сигнала STEC при<br>
обращении к адресу (STEC)<br>
EDH  Шлюз с IBM PC<br>
</pre>

# Author info #
http://vector06c.narod.ru/

# Из выпуска Вектор-Юзер №3 стр.3 #
СВП (_счетчик вертикальных позиций_) экрана производит счет в три этапа:
  1. от 0 до 280 _(или 288?)_. При высоком уровне сигнала на 3,4,8 разрядах СВП, D6 устанавливается в исходное (нулевое) состояние;
  1. от 289 до 312. При высоком уровне сигнала на тех же разрядах D6 устанавливается в нулевое состояние;
  1. от 312 до 328. При коде 328 (высокий уровень сигнала на 3, 6, 8) СВП устанавливается в исходное (нулевое) состояние. Суммарный коэффициент пересчета СВП составляет 312. При этом длительность кадра составляет 312x64мкс = 19.968мс. Из них 256x64=18.4мс - отображение информационных строк растра; по 16x64мкс = 1.02мс - верхний и нижний бордюры; 24x64мкс = 1.5мс - кадровый синхроимпульс.