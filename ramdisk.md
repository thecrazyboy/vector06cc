Описание реализации квазидиска в vector06cc находится в разделе [Implementation Notes](ImplementationNotes.md), параграф Mock Disk. Здесь приводятся исторически-технические документы из которых можно понять устройство квазидиска в его изначальном исполнении.

## Описание функционирования квазидиска "Омск", модель 2. ##
```
	Квазидиск состоит из следующих узлов: ОЗУ (DD10-DD17), усилителя записи
(DD9),  усилителя считывания (DD8),  регистра режима (DD4),  селектора регистра
режима (DD2, DD1.1, DD3.1), селектора подэкранного ОЗУ (DD3.2,  DD3.3,  DD7.3),
коммутатора страниц (DD6) и дополнительного коммутатора (DD5).
	Управляет режимами работы квазидиска регистр режима.   Он  доступен  со
стороны процессора по записи как порт 10H.
	Младшие 4 бита регистра режима (выводы 2,5,7,10)  определяют номер зоны
квазидиска, доступной соответственно как подэкранное ОЗУ или как стек.  Старшие
биты (выводы 12,15)  единичным значением разрешают доступ соответственно как  к
стеку и как к подэкранному ОЗУ (по адресам A000H-DFFFH).
	Процессы записи информации в ОЗУ квазидиска и считывания ее  отличаются
лишь тем,  что при записи компьютер устанавливает низкий уровень сигнала  /ЗПЗУ
(конт.  27 раз'ема).  Этот уровень устанавливается после отрицательного  фронта
сигнала CAS,  и на выходах м/с ОЗУ при этом присутствует ранее содержащаяся там
информация.  Поскольку сигнал /ЧТЗУ во  время  записи  имеет  высокий  уровень,
усилитель считывания отключен,  и информация с выходов м/с ОЗУ не  проходит  на
шину данных и не искажает записываемую информацию.
	Рассмотрим процесс установки адреса.  Как известно,  м/с  динамического
ОЗУ (в частности, используемые РУ7) требуют периодической регенерации хранящей-
ся в них информации.  В "Векторе" регенерацию внутреннего ОЗУ производит видео-
контроллер. Однако последний производит регенерацию только по 256 адресам,  что
позволяет использовать только м/с РУ5, т.к.  РУ7 требуют регерации по 512 адре-
сам.  Для обеспечения регенерации РУ7 внесены небольшие изменения в схему "Век-
тора".
	Процесс регенерации состоит в том,  что на адресные входы ОЗУ  подается
адрес (байта из видеоОЗУ компьютера),  затем через промежуток  времени  следует
отрицательный фронт сигнала RAS.  Сигнал CAS  на  ОЗУ  электронного  диска  при
регенерации не подается.  В первую очередь необходимо для обеспечения регенера-
ции вывести из компьютера сигнал, который будет подаваться на 9-й адресный вход
РУ7 (выв.1).  В качестве такого сигнала выбран  сигнал,   "следующий"  за  тем,
который подается на 8-й адресный вход. Для того, чтобы отличить обращение к ОЗУ
для регенерации (в диске на РУ5 в этом нет необходимости:  выборка нужной  зоны
производится подачей сигнала CAS  на одну из 4-х линеек,  а в диске на РУ7 зона
выбирается адресным битом), требуется сигнал MX2,  равный 0 при регенерации и 1
при обращении от процессора. Сигнал MX2 управляет работой коммутатора страниц -
при низком уровне на его выходах присутствует сигнал регенерации 9-го адресного
входа.
	Необходимость в дополнительном коммутаторе вызвана ошибкой  разработчи-
ков "Вектора".  Изначально квазидиск планировалось использовать как "расширение
стека". Поэтому на раз'ем компьютера выведен сигнал СТЕК,  равный 1 при обраще-
нии к стеку. Если стековые операции разрешены, то на выв.  3 DD7.1 устанавлива-
ется высокий уровень,  и при MX2=1 на выходы DD5 проходят  сигналы  с  DD4/7  и
DD4/10 - номер зоны при обращении к стеку. Если же СТЕК=0, MX2=1, то на выходах
DD5 - номер зоны "подэкранного ОЗУ".
	Однако сигнал СТЕК появляется на системном раз'еме после  сигнала  RAS.
Следовательно,  сигналом RAS  должны стробироваться 9 бит адреса,  а  компьютер
выдает только 8 (по линиям ШАП[0]  - ШАП[7]).  Поэтому в схему  квазидиска  был
введен дополнительный коммутатор DD5. Учитывается,  что разряд ШАП[7]  в момент
действия сигнала CAS  передает на адресные входы ОЗУ разряд A14.  Разряд A14 не
передается на линии ШАП во время действия сигнала RAS,  но в  то  же  время  он
постоянно присутствует на линии  ШАВВ[6].   Поэтому  дополнительный  коммутатор
подает его на адресные входы ОЗУ во время действия сигнала RAS при условии, что
MX2=1 (иначе подается сигнал регенерации).  Это дает возможность во время  дей-
ствия сигнала CAS  произвести выбор нужной зоны двумя  битами,   проходящими  с
коммутаторов на адресные входы.
	Важную роль в работе квазидиска играет сигнал БЛК.  Отрицательный  уро-
вень этого сигнала запрещает обмен информацией между процессором  и  внутренним
ОЗУ компьютера.  Квазидиск вырабатывает его,  если идентифицирует  обращение  к
своему ОЗУ, и соответствующее обращение разрешено регистром режима.
	Итак, установка адреса происходит в следующем порядке:
 1. Компьютер устанавливает MX2=1,  выдает на ШАВВ старшую половину адреса,  на
ШАП - "первую часть" адреса.
 2. Квазидиск анализирует содержимое ШАВВ на предмет попадания адресов в диапа-
зон 0A0H - 0DFH, т.е. подэкранного ОЗУ.  Если да,  и бит 5 регистра режима = 1,
то вырабатывается сигнал БЛК=0. На адресные входы ОЗУ подаются 9 бит адреса, 9-
й бит сформирован дополнительным коммутатором.
 3. Компьютер устанавливает RAS=0.
 4. Компьютер выдает на ШАП "вторую часть" адреса.
 5. Компьютер выставляет корректное значение сигнала СТЕК, тем самым становится
известным номер зоны квазидиска.  Если СТЕК=1 и бит 4 регистра режима  =1,   то
вырабатывается сигнал БЛК=0 и  активной  зоной  считается  зона,   определяемая
битами 2 и 3 регистра режима (зона стека).  Также в этот момент устанавливается
корректное значение сигналов ЗПЗУ, ЧТЗУ. Нулевое значение ЧТЗУ разрешает работу
усилителя считывания. Сигнал БЛК=0 определяет направление передачи от ОЗУ к ПК.
 6. Компьютер устанавливает (при условии,  что БЛК=0)  CAS=0.  Происходит выбор
зоны ЭД и обмен информацией.
 7. Компьютер устанавливает MX2=0,  RAS=CAS=1.  Исходное состояние.
 8.  Компьютер устанавливает на ШАП и дополнительном сигнале (Refresh)  адрес
регенерации. Через промежуток времени устанавливается RAS=0. Цикл регенерации.
 9. Компьютер устанавливает RAS=1. Затем процесс повторяется.

	Примечание.  В модели "Омск-1" не использовался дополнительный коммута-
тор, вместо этого в схему вносились изменения для того, чтобы обеспечить посту-
пление сигнала СТЕК до сигнала RAS.
```

## Программисту об электронном диске ##
```
	    Для работы с ЭД программисту необходимо знать, что: 
- при работе в ОС "МикроДОС" об'ем ОЗУ ЭД распределяется следующим образом:
	234 К ОЗУ пользователя,
	 16 К "подэкранное" ОЗУ,
	  4 К контрольные суммы,
	  2 К каталог.   
-  доступ  к ЭД осуществляется через порт 10h; в этот порт записывается байт,
определяющий режим доступа к ЭД и номер одного из  четырех  64-х  килобайтных
блоков, к которому разрешается доступ.  Структура управляющего байта:

			   D7 D6 D5 D4 D3 D2 D1 D0
где:
D1,D0 - биты, которые задают номер блока при обращении к ЭД "как ОЗУ",
D3,D2 - биты, которые задают номер блока при обращении к ЭД "как стек",
D4 - указывает на вкл/выкл режима ЭД "как стек",
	0 - режим выключен;
	1 - режим включен;
D5 - указывает на вкл/выкл режима ЭД "как ОЗУ",
	0 - режим выключен;
	1 - режим включен;
D7,D6 - не используються.
   В  режиме  "как  ОЗУ"  (D5=1,  D4=0)  в  адресное  пространство A000-DFFFh
процессора БПЭВМ  подключается  память  соответствующего  блока  ЭД  т.е. при
обращении к этим адресам данные будут записываться в ОЗУ ЭД, а не в ОЗУ БПЭВМ.
   В  режиме  "как  стек"  (D5=0, D4=1) при выполнении команд, обращающихся к
стеку, данные будут выбираться из ОЗУ ЭД, а не  БПЭВМ.   Таким  образом,  для
полного использования ОЗУ ЭД необходимо использовать режим "как стек".
   Если  установлены  оба  режима  (D5=1,  D4=1),  то при выполнении стековых
операций в адресах A000-DFFFh доступ будет обеспечен к блоку,  который  задан
разрядами D3, D2.
   Номер 64-х килобайтного блока задается инверсно, то есть:
	11B - блок 0
	10B - блок 1
	01B - блок 2
	00B - блок 3
   Пример:  стандартная  конфигурация  МикроДОС  работает  в  режиме  23h или
00010011B, что означает нулевой блок ЭД работающий в режиме "как ОЗУ".

По материалам фирмы "PC - Invoservise"
							Усков И.М.  
```

## Рекомендации по подключению квазидиска к ПЭВМ "Вектор-06Ц", "Криста-2" ##
```
						Festina lente
						  (торопись медленно)

	Предполагается, что Начальный Загрузчик (микросхема ПЗУ D9, у "Кристы"
DD23) в ПЭВМ заменен. Иначе работа с квазидиском гораздо менее эффективна.
 
	1. Oсмотрите внимательно изделие  -  все ли припаяно, ничего не оторва-
лось, не сломалось?
	2. Проверьте с помощью "цешки" или мультиметра отсутствие замыкания
между цепями питания (общий и +5в, общий и +12в.).
	3. Перережьте дорожки у контактов  36 и 39  (у "Кристы" - 20 и 18) сис-
темного раз"ема. На контакт 36 заведите сигнал со 2-й ноги м/с D11 (D6 "Вектор-
06Ц-02", DD33 у "Кристы").  На 39 контакт - с 11-й ноги этой же м/схемы.  D11 -
это К155КП2, самая ближняя к процессору из всех КПшек.
       Сразу же проверьте - идет  ли  на  21  контакт раз"ема "ВУ" сигнал RAS с
14-й ноги м/сх D34 (это 580ВА86 рядом с  м/с К580ВИ53). Дело в том, что на каж-
дом третьем Векторе  этот сигнал  либо  не доходит до 14-й ноги D34,  либо идет
почему-то на 15-ю ногу.
	4. Как теперь сам квазидиск подключить к ПЭВМ? Есть несколько способов.
- припаять к нему ответную часть системного раз"ема. Тогда либо Вы займете
раз"ем, либо придется сооружать переходник. Второй вариант более умный.
- соединить "навсегда" квазидиск с ПЭВМ. Это замечательный вариант для "Кристы"
поскольку  у нее достаточно место для него рядом с системным раз"емом (над м/сх
ПЗУ, рядом с динамиком). У "Вектора" квазидиск закроет процессор. Это плохо.
- соединить  квазидиск с контроллером НГМД. Это самый лучший вариант, если есть
контроллер.
	Итак, выберите какой-либо вариант и -
	5. Подключите  квазидиск  к  ПЭВМ, включите ПЭВМ и убедитесь, что он не
мешает работе компьютера. Выключите ПЭВМ.
	6. Проверить  квазидиск можно Тестом Устройств "Вектора". Но он не даст
диагностику ошибок, если таковые будут. Нужна спец. программа TESTBEST. Предпо-
ложим, она у Вас есть и Вы ее запустили.
        Должна появиться картинка из четырех блоков по 8 полос в блоке.  Каждая
из полос в блоке представляет соответствующую микросхему.  Если возникают проб-
лемы с какой-то из микросхем, над соответствующей полосой появляется крест.
	7. Если  картинка не появилась, а на экране что-то елозит и изредка по-
является и эта картинка  и тут же исчезает - явно не проходит питание на квази-
диск. Иначе может быть лишь  в  случае, если к-либо м/схема либо "сдохла", либо
не запитана (имеются в виду обслуживающие м/схемы, т.е. все, кроме РУ7). Но это
почти исключено. Если тест работает,  но  бракует м/схемы - смотри  пункт 11.
 	8. Итак, этот  тест  прошел нормально.  Делаем  последнюю проверку. Для
этого нам надо отформатировать новую дискету  и сгенерировать на нее ДОС, рабо-
тающую с  квазидиском.
A>SYSGEN DOS201.COM A:100 <ВК>,
	9. Ну  вот теперь  загрузитесь уже с этой, новой дискеты - т.е. нажмите
ВВОД-БЛК. Все нормально?  Предположим - да.  Тогда загрузитесь опять, но теперь
при загрузке удерживайте клавишу "УС".  Несколько секунд у Вас будет экран пуст
- это форматируется квазидиск. Теперь введите очень простую команду:
А>8 <ВК>,
8 - это команда проверки квазидиска на сбои. Если проверка прошла без замечаний
- можете считать, что Ваши мучения окончились. Если вылезла куча ошибок - читай
пункт 11.
        10. Этот пункт для тех, у кого нет дисковода. Операционную систему
необходимо загрузить с магнитофона и выполнить команду:
A>1 45 OS.COM
	Теперь система у Вас находится на квазидиске и при перезапуске ПЭВМ
произойдет загрузка системы с квазидиска. Все остальное как в п. 9

	11. В чем могут быть причины неустойчивой работы диска или того, что
он вообще не работает ?
	Самая первая и основная причина - Вы чего-то напутали с контактами
36 и 39 (см. пункт 3) или с подсоединением квазидиска к системному раз"ему.
	Другие причины :
	- питание. Попробуйте порегулировать от 4,7 до 5,4 в.
	- на системный раз"ем не приходят необходимые сигналы. Бывает и на
	  заводе брак.

			Удачи  Вам !
```